<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>アイコン生成ツール</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
    }
    button {
      background: #3B82F6;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
    }
    button:hover {
      background: #2563EB;
    }
    .preview {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    .preview-item {
      border: 1px solid #E5E7EB;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
    }
    canvas {
      border: 1px solid #E5E7EB;
      border-radius: 4px;
    }
    .instructions {
      background: #FEF3C7;
      border: 1px solid #FCD34D;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>🦝 Tanus Inkwell アイコン生成</h1>

  <div class="instructions">
    <h3>📝 使い方</h3>
    <ol>
      <li>「アイコンを生成」ボタンをクリック</li>
      <li>各サイズのアイコンが表示されます</li>
      <li>各画像を右クリック → 「名前を付けて画像を保存」</li>
      <li>ファイル名を指定して <code>public/icons/</code> に保存してください</li>
    </ol>
  </div>

  <button onclick="generateIcons()">アイコンを生成</button>

  <div class="preview" id="preview"></div>

  <script>
    const svgContent = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
  <!-- Background Circle -->
  <circle cx="256" cy="256" r="256" fill="#8B7355"/>

  <!-- Tanuki Body (darker brown) -->
  <ellipse cx="256" cy="320" rx="140" ry="120" fill="#6B5345"/>

  <!-- Tanuki Head -->
  <circle cx="256" cy="200" r="120" fill="#A0826D"/>

  <!-- Ears -->
  <ellipse cx="190" cy="130" rx="35" ry="50" fill="#6B5345"/>
  <ellipse cx="322" cy="130" rx="35" ry="50" fill="#6B5345"/>
  <ellipse cx="190" cy="135" rx="20" ry="30" fill="#D4A574"/>
  <ellipse cx="322" cy="135" rx="20" ry="30" fill="#D4A574"/>

  <!-- Face mask pattern (dark brown around eyes) -->
  <ellipse cx="220" cy="180" rx="45" ry="55" fill="#3D2817"/>
  <ellipse cx="292" cy="180" rx="45" ry="55" fill="#3D2817"/>

  <!-- White eye area -->
  <ellipse cx="220" cy="185" rx="28" ry="35" fill="#FFFFFF"/>
  <ellipse cx="292" cy="185" rx="28" ry="35" fill="#FFFFFF"/>

  <!-- Eyes -->
  <circle cx="220" cy="190" r="18" fill="#2C1810"/>
  <circle cx="292" cy="190" r="18" fill="#2C1810"/>

  <!-- Eye shine -->
  <circle cx="226" cy="185" r="6" fill="#FFFFFF"/>
  <circle cx="298" cy="185" r="6" fill="#FFFFFF"/>

  <!-- Nose -->
  <ellipse cx="256" cy="220" rx="15" ry="12" fill="#2C1810"/>

  <!-- Snout highlight -->
  <ellipse cx="256" cy="235" rx="30" ry="20" fill="#C9A882" opacity="0.6"/>

  <!-- Mouth -->
  <path d="M 256 220 Q 246 230 240 228" stroke="#2C1810" stroke-width="3" fill="none" stroke-linecap="round"/>
  <path d="M 256 220 Q 266 230 272 228" stroke="#2C1810" stroke-width="3" fill="none" stroke-linecap="round"/>

  <!-- Pen (held in front) -->
  <g transform="translate(340, 280) rotate(-25)">
    <!-- Pen body (fountain pen) -->
    <rect x="0" y="0" width="90" height="16" rx="3" fill="#1E40AF"/>
    <!-- Pen clip -->
    <rect x="15" y="-3" width="4" height="22" rx="2" fill="#60A5FA"/>
    <!-- Pen tip -->
    <path d="M 90 0 L 110 8 L 90 16 Z" fill="#374151"/>
    <!-- Pen nib -->
    <path d="M 110 8 L 125 8" stroke="#D1D5DB" stroke-width="1"/>
    <!-- Pen shine -->
    <rect x="25" y="4" width="40" height="4" rx="2" fill="#3B82F6" opacity="0.5"/>
  </g>

  <!-- Paws -->
  <ellipse cx="200" cy="400" rx="40" ry="25" fill="#6B5345"/>
  <ellipse cx="312" cy="400" rx="40" ry="25" fill="#6B5345"/>

  <!-- Belly patch (lighter) -->
  <ellipse cx="256" cy="340" rx="60" ry="70" fill="#C9A882" opacity="0.4"/>
</svg>`;

    function svgToPng(svgString, size, callback) {
      const img = new Image();
      const blob = new Blob([svgString], { type: 'image/svg+xml' });
      const url = URL.createObjectURL(blob);

      img.onload = () => {
        const canvas = document.createElement('canvas');
        canvas.width = size;
        canvas.height = size;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, size, size);
        URL.revokeObjectURL(url);
        callback(canvas);
      };

      img.src = url;
    }

    function generateIcons() {
      const preview = document.getElementById('preview');
      preview.innerHTML = '';

      const sizes = [
        { size: 192, name: 'icon-192.png', label: '192x192 (通常)' },
        { size: 512, name: 'icon-512.png', label: '512x512 (通常)' },
        { size: 192, name: 'icon-maskable-192.png', label: '192x192 (Maskable)', maskable: true },
        { size: 512, name: 'icon-maskable-512.png', label: '512x512 (Maskable)', maskable: true },
      ];

      sizes.forEach(({ size, name, label, maskable }) => {
        const svg = maskable ? addMaskablePadding(svgContent) : svgContent;

        svgToPng(svg, size, (canvas) => {
          const div = document.createElement('div');
          div.className = 'preview-item';

          const title = document.createElement('h3');
          title.textContent = label;
          div.appendChild(title);

          div.appendChild(canvas);

          const filename = document.createElement('p');
          filename.textContent = name;
          filename.style.fontFamily = 'monospace';
          filename.style.fontSize = '14px';
          filename.style.marginTop = '10px';
          div.appendChild(filename);

          const downloadBtn = document.createElement('button');
          downloadBtn.textContent = 'ダウンロード';
          downloadBtn.onclick = () => {
            const link = document.createElement('a');
            link.download = name;
            link.href = canvas.toDataURL('image/png');
            link.click();
          };
          div.appendChild(downloadBtn);

          preview.appendChild(div);
        });
      });
    }

    function addMaskablePadding(svgContent) {
      // Maskable iconは周囲に20%のセーフエリアが必要
      return svgContent.replace(
        'viewBox="0 0 512 512"',
        'viewBox="-51.2 -51.2 614.4 614.4"'
      );
    }
  </script>
</body>
</html>
